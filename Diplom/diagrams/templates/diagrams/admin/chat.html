{% extends "admin/chat.html" %}
{% load static %}

{% block extrahead %}
    {{ block.super }}
    <style>
        /* Ваши стили */
    </style>

    <script>
       document.addEventListener("DOMContentLoaded", function () {
    const chatSocket = new WebSocket(
        'ws://' + window.location.host + '/ws/chat/'  // Общий WebSocket
    );

    // Обработка входящих сообщений
    chatSocket.onmessage = function (e) {
        const data = JSON.parse(e.data);
        const messages = document.getElementById('messages');

        const messageElement = document.createElement('div');
        messageElement.classList.add('message');

        const usernameElement = document.createElement('span');
        usernameElement.classList.add('username');
        usernameElement.textContent = data.username + ': ';

        const messageTextElement = document.createElement('span');
        messageTextElement.textContent = data.message;

        const timestampElement = document.createElement('div');
        timestampElement.classList.add('timestamp');
        timestampElement.textContent = new Date().toLocaleTimeString();

        messageElement.appendChild(usernameElement);
        messageElement.appendChild(messageTextElement);
        messageElement.appendChild(timestampElement);

        messages.appendChild(messageElement);
        messages.scrollTop = messages.scrollHeight;
    };

    // Отправка сообщения
    const sendButton = document.getElementById('send-button');
    if (sendButton) {
        sendButton.onclick = function () {
            const messageInput = document.getElementById('message-input');
            const message = messageInput.value.trim();

            if (message) {
                chatSocket.send(JSON.stringify({
                    'username': 'Администратор',  // Имя администратора
                    'message': message
                }));
                messageInput.value = '';
            }
        };
    }
});
    </script>
{% endblock %}

{% block content %}
    <div id="chat">
        <h1>Административный чат</h1>
        <div id="messages">
            <!-- История чата будет загружена здесь -->
        </div>
        <input type="text" id="message-input" placeholder="Введите сообщение...">
        <button id="send-button">Отправить</button>
    </div>
{% endblock %}